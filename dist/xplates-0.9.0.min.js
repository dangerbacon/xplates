/** XPlates version 0.9.0
  * @license undefined
  * @preserve 
 **/
XPlates=function(){function r(){return this instanceof r?r:a.call(null,null,arguments)}function e(r){var e=r.match(h);if(!e)throw new Error('XPlates:  Improper format for array iterator "'+r+'"');return{l:d(),i:d(e[3]),v:d(e[5],!0),o:e[1]}}function n(r){return r.length?w()+JSON.stringify(r):""}function t(r,e,t,a,o){t=t||"xplate",e=e||["arg"],s=0,i={},p=l=d(o.outvar||_,!1,""),c=!1,u=!1;for(var g,v="",h=0,m=f.ops||{};g=a.exec(r);){if(v+=n(r.substr(h,g.index-h)),!c||"!"===g[1]&&/^[\s\r\n]*noparse[\s\r\n]*=/.test(g[2])){var w=g[1],y=m[w]||P[w];if(!y)throw new Error("XPlates:  Undefined operator "+w);v+=y(g[2].replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s*\/\/.*$/gm,"").trim())}else v+=n(g[0]);h=g.index+g[0].length}v+=n(r.substr(h,r.length-h)),v+=x()+"return "+p+"; }";var b="return function "+t+"("+e.join(",")+"){var ",X=0;for(var S in i)b+=(X++?",":"")+S+("undefined"==typeof i[S]?"":"="+JSON.stringify(i[S]));b+=";";var E=[],O=[],$=f.reqs||{};for(var S in $)E.push(S),O.push($[S]);E.push(b+v);try{var J=Function.apply(null,E).apply(null,O);return J}catch(N){throw N.message="XPlates compile error: "+N.message+"\n"+b+v,N}}function a(e,n){var a=n[0],o=n[1],s=n[2],u=n[3],i=n[4]||{};if(!r.languages.hasOwnProperty(a))throw new Error("XPlates: Unknown language "+a);if(f=r.languages[a],i.preprocess){var l=[],p=[];for(var c in i.preprocess)l.push(c),p.push(i.preprocess[c]);var h=t(o,l,null,v,i);o=h.apply(null,p)}f.precompile&&(o=f.precompile(o,i));var m=t(o,s,u,g,i);return e&&u&&(e[u]=m,m.__xplate_language=a),m}function o(e){var n={},t="",a="";t+="var "+(e||"xplates")+"=new (function(){\n";for(var o in this){var s=this[o];if("function"==typeof s&&"string"==typeof s.__xplate_language&&(a+="this["+JSON.stringify(o)+"] = "+s.toString()+";\n",!n[s.__xplate_language])){n[s.__xplate_language]=!0;var u=r.languages[s.__xplate_language].reqs;for(var i in u){var l=u[i];t+="var "+i+" = "+("function"==typeof l?l.toString():JSON.stringify(l))+";\n"}}}return a+="})();\n",t+a}var s,u,i,l,p,c,f,g=/<%([~!@$^*\-=+:.\?]*)[\s\r\n]*([\s\S]*?)[\s\r\n]*%>/g,v=/<#([~!@$^*\-=+:.\?]*)[\s\r\n]*([\s\S]*?)[\s\r\n]*#>/g,h=/^(.*?)[\s\r\n]*(:[\s\r\n]*(\w+)?)?[\s\r\n]*(:[\s\r\n]*(\w+)?)?$/,m=/^(\w+)[\s\r\n]*=(.*)$/,_="out",w=r.sIn=function(){return u?"+":(u=!0)&&l+"+="},x=r.sOut=function(){return u?(u=!1)||";":""},d=r.sVar=function(r,e,n){if(!r){if(e)return null;r="__xp"+ ++s}return i[r]=n,r},y=r.sEscape=function(r){return(f.escapeFunc||"")+"("+r+")"},P={};return P[""]=function(r){return x()+r+";"},P["="]=function(r){return w()+y('""+('+r+")")},P["=="]=function(r){return w()+'(""+('+r+"))"},P["?"]=function(r){return r?x()+"if("+r+"){":x()+"};"},P["??"]=function(r){return r?x()+"}else if("+r+"){":x()+"} else {"},P["~"]=function(r){if(!r)return x()+"};";var n=e(r);return x()+n.l+"="+n.o+";for("+n.i+"=0;"+n.i+"<"+n.l+".length;"+n.i+"++){"+(n.v?n.v+"="+n.l+"["+n.i+"];":"")},P["~~"]=function(r){if(!r)return x()+"};";var n=e(r);return x()+n.l+"="+n.o+";for("+n.i+"="+n.l+".length-1;"+n.i+">=0;"+n.i+"--){"+(n.v?n.v+"="+n.l+"["+n.i+"];":"")},P["+"]=function(r){if(!r)return x()+"};";var n=e(r);return x()+n.l+"="+n.o+";for("+n.i+" in "+n.l+"){"+(n.v?n.v+"="+n.l+"["+n.i+"];":"")},P["!"]=function(r){var e=x(),n=r.match(m);if(!n)throw new Error('XPlates:  Improper format for option setting "'+r+'"');var t=n[1];try{var a=JSON.parse(n[2])}catch(o){throw new Error('XPlates:  Invalid JSON for option value "'+n[2]+'"')}switch(t){case"outvar":if("string"!=typeof a||!a.match(/^\w+$/))throw new Error("XPlates:  outvar must be a valid variable name! "+r);l=d(a,!1,"");break;case"returnvar":if("string"!=typeof a||!a.match(/^\w+$/))throw new Error("XPlates:  returnvar must be a valid variable name! "+r);p=d(a,!1,"");break;case"noparse":c=!!a;break;default:throw new Error("XPlates:  Unknown option "+t)}return e},r.bundle=function(){var r=function(){return a.call(null,r,arguments)};return Object.defineProperty(r,"toString",{value:o}),r},r.languages={},r}(),function(){function r(r,e,n,t,a,o,s){return" "+t+"="+o+s.trim().replace(l," $1")+o}function e(e,n){if(!n.strip)return e;for(var t,a,o="",l=[],p={script:!0,pre:!0},c=0;t=s.exec(e);)if(t.index>c&&(o+=e.substr(c,t.index-c)),c=t.index+t[0].length,t[1]){o+=t[1].replace(i,r).replace(u,">");var f=t[3].toLowerCase();if(f in p)if(t[2])for(;(a=l.pop())&&a!==f;);else l.push(f)}else t[5]?o+=l.length?t[5]:t[5].trim().replace(/\s*[\r\n][\r\n\s]*/g,"\n").replace(/\s+/g," "):t[6]&&(o+=t[6]);return e.length>c&&(o+=e.substr(c,e.length-c)),o}function n(r){return p[r]}function t(r){return r.replace(/[&<>"']/g,n)}function a(r){return c[r]}function o(r){return r.replace(/[&<]/g,a)}var s=/(<(\/?)([\w\-]+)([^<]+|<%.*?%>)*?>)|([^<]+)|(<%.*?%>)/g,u=/[\s\r\n]+>$/,i=/([\s\r\n]+)(([\w-]+)(=(")((<%.*?%>|[^"])*)(\5))?)/g,l=/[\s\r\n]+(<%.*?%>)/g;XPlates.languages.text={};var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};XPlates.languages.html={escapeFunc:"__xphtmlescape",reqs:{__xphtmlchars:p,__xphtmlescape:t,__xphtmlreplace:n},precompile:e};var c={"&":"&amp;","<":"&lt;"};XPlates.languages.md={escapeFunc:"__xpmdescape",reqs:{__xpmdchars:c,__xpmdescape:o,__xpmdreplace:a}},XPlates.languages.url={escapeFunc:"encodeURIComponent"}}(),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=XPlates);