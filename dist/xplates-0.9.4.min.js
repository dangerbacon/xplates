/** XPlates version 0.9.4
  * @license MIT
  * @preserve 
 **/
XPlates=function(){function r(){return this instanceof r?r:a.call(null,null,arguments)}function n(r){var n=r.match(_);if(!n)throw new Error('XPlates:  Improper format for array iterator "'+r+'"');return{l:X(),i:X(n[3]),v:X(n[5],!0),o:n[1]}}function e(r,n){return r.length?P()+JSON.stringify(h?h(r,n):r):""}function t(r,n,t,a,o){t=t||"xplate",n=n||["arg"],i=0,u={},p=l=X(o.outvar||x,!1,""),f=[],c=!1,s=!1;var h,v="",m=0,_=g.ops||{};for(a.lastIndex=null;h=a.exec(r);){if(v+=e(r.substr(m,h.index-m),o),!c||"!"===h[1]&&/^[\s\r\n]*noparse[\s\r\n]*=/.test(h[2])){var w=h[1],d=_[w]||E[w];if(!d)throw new Error("XPlates:  Undefined operator "+w);v+=d(h[2].replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s*\/\/.*$/gm,"").trim())}else v+=e(h[0],o);m=h.index+h[0].length}if(f.length)throw new Error("XPlates:  Unmatched @ operators!");if(f.length)throw new Error("XPlates:  Unmatched @ operators!");v+=e(r.substr(m,r.length-m),o),v+=y()+"return "+l+"; }";var P="return function "+t+"("+n.join(",")+"){var ",S=0;for(var O in u)P+=(S++?",":"")+O+("undefined"==typeof u[O]?"":"="+JSON.stringify(u[O]));P+=";";var b=[],$=[],I=g.reqs||{};for(var O in I)b.push(O),$.push(I[O]);for(var O in o.predefined||{})b.push(O),$.push(o.predefined[O]);b.push(P+v);try{var U=Function.apply(null,b).apply(null,$);return U}catch(J){throw J.message="XPlates compile error: "+J.message+"\n"+P+v,J}}function a(n,e){var a=e[0],o=e[1],i=e[2],s=e[3],u=e[4]||{};if(!r.languages.hasOwnProperty(a))throw new Error("XPlates: Unknown language "+a);if(g=r.languages[a],g.init&&g.init(),h=null,u.preprocess){var l=[],p=[];for(var f in u.preprocess)l.push(f),p.push(u.preprocess[f]);var c=t(o,l,null,m,u);o=c.apply(null,p)}h=g.filter;var _=t(o,i,s,v,u);return n&&s&&(n[s]=_,_.__xplate_language=a),_}function o(n){var e={},t="",a="";t+="var "+(n||"xplates")+"=new (function(){\n";for(var o in this){var i=this[o];if("function"==typeof i&&"string"==typeof i.__xplate_language&&(a+="this["+JSON.stringify(o)+"] = "+i.toString()+";\n",!e[i.__xplate_language])){e[i.__xplate_language]=!0;var s=r.languages[i.__xplate_language].reqs;for(var u in s){var l=s[u];t+="var "+u+" = "+("function"==typeof l?l.toString():JSON.stringify(l))+";\n"}}}return a+="})();\n",t+a}var i,s,u,l,p,f,c,g,h,v=/<%([~!@$^*\-=+:.\?]*)[\s\r\n]*([\s\S]*?)[\s\r\n;]*%>/g,m=/<#([~!@$^*\-=+:.\?]*)[\s\r\n]*([\s\S]*?)[\s\r\n;]*#>/g,_=/^(.*?)[\s\r\n]*(:[\s\r\n]*(\w+)?)?[\s\r\n]*(:[\s\r\n]*(\w+)?)?$/,w=/^(\w+)[\s\r\n]*=(.*)$/,d=/^[a-z_$][\w$]*$/i,x="out",P=r.sIn=function(){return s?"+":(s=!0)&&p+"+="},y=r.sOut=function(){return s?(s=!1)||";":""},X=r.sVar=function(r,n,e){if(!r){if(n)return null;r="__xp"+ ++i}return u[r]=e,r},S=r.sEscape=function(r){return(g.escapeFunc||"")+"("+r+")"},E={};return E[""]=function(r){return y()+r+";"},E["="]=function(r){return P()+S('""+('+r+")")},E["=="]=function(r){return P()+'(""+('+r+"))"},E["?"]=function(r){return r?y()+"if("+r+"){":y()+"};"},E["??"]=function(r){return r?y()+"}else if("+r+"){":y()+"} else {"},E["~"]=function(r){if(!r)return y()+"};";var e=n(r);return y()+e.l+"="+e.o+";for("+e.i+"=0;"+e.i+"<"+e.l+".length;"+e.i+"++){"+(e.v?e.v+"="+e.l+"["+e.i+"];":"")},E["~~"]=function(r){if(!r)return y()+"};";var e=n(r);return y()+e.l+"="+e.o+";for("+e.i+"="+e.l+".length-1;"+e.i+">=0;"+e.i+"--){"+(e.v?e.v+"="+e.l+"["+e.i+"];":"")},E["+"]=function(r){if(!r)return y()+"};";var e=n(r);return y()+e.l+"="+e.o+";for("+e.i+" in "+e.l+"){"+(e.v?e.v+"="+e.l+"["+e.i+"];":"")},E["!"]=function(r){var n=y(),e=r.match(w);if(!e)throw new Error('XPlates:  Improper format for option setting "'+r+'"');var t=e[1];try{var a=JSON.parse(e[2])}catch(o){throw new Error('XPlates:  Invalid JSON for option value "'+e[2]+'"')}switch(t){case"noparse":c=!!a;break;default:throw new Error("XPlates:  Unknown option "+t)}return n},E["@"]=function(r){if(r){if(!d.test(r))throw new Error("XPlates:  Invalid variable name "+r);return f.push(p),p=r,X(r),y()+r+'="";'}if(!f.length)throw new Error("XPlates:  Unmatched @ operators!");return p=f.pop(),y()},r.bundle=function(){var r=function(){return a.call(null,r,arguments)};return Object.defineProperty(r,"toString",{value:o}),r},r.languages={},r}(),function(){function r(){a=[],o=!1}function n(r,n){if(!n.strip)return r;for(var e,t,u="";e=i.exec(r);)if(e[1]){if(o=!0,u+=e[1],e[3]){var l=e[3].toLowerCase();if(l in s)if(e[2])for(;(t=a.pop())&&t!==l;);else a.push(l)}}else e[4]?(o=!1,u+=e[4]):u+=!a.length||o?e[5].trim().replace(/\s*[\r\n][\r\n\s]*/g,"\n").replace(/\s+/g," ").replace(/"\s+/g,'"').replace(/\s+"/g,'"'):e[5];return u}function __xphtmlreplace(r){return __xphtmlchars[r]}function __xphtmlescape(r){return r.replace(/[&<>"']/g,__xphtmlreplace)}function e(r){return u[r]}function t(r){return r.replace(/[&<]/g,e)}var a,o,i=/(<(\/?)([\w\-!]*)[\s\r\n]?)|(>)|([^<>]+)/g,s={script:!0,pre:!0};XPlates.languages.text={};var __xphtmlchars={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};XPlates.languages.html={escapeFunc:"__xphtmlescape",reqs:{__xphtmlchars:__xphtmlchars,__xphtmlescape:__xphtmlescape,__xphtmlreplace:__xphtmlreplace},init:r,filter:n};var u={"&":"&amp;","<":"&lt;"};XPlates.languages.md={escapeFunc:"__xpmdescape",reqs:{__xpmdchars:u,__xpmdescape:t,__xpmdreplace:e}},XPlates.languages.url={escapeFunc:"encodeURIComponent"}}(),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=XPlates);